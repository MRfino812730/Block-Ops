<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>BLOCKS OPS - Full Edition</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    <style>
        body { margin: 0; background: #000; overflow: hidden; font-family: 'Courier New', monospace; }
        
        /* INTERFAZ DEL MENÚ (RESTAURADA) */
        #menu-inicio {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(0,0,0,0.8), rgba(0,0,0,0.8)), radial-gradient(circle, #333 0%, #000 100%);
            display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 1000; color: white; text-align: center;
        }
        .title-container { border-top: 4px solid #f00; border-bottom: 4px solid #f00; padding: 20px 0; margin-bottom: 20px; width: 80%; max-width: 800px; }
        #menu-inicio h1 { font-size: 80px; margin: 0; letter-spacing: 15px; color: #fff; text-shadow: 0 0 20px #f00; font-weight: 900; }
        
        /* SELECTOR DE MAPAS (RESTAURADO) */
        .map-selector { display: flex; gap: 20px; margin: 20px 0; }
        .map-card { border: 2px solid #444; padding: 15px; cursor: pointer; width: 160px; background: rgba(0,0,0,0.5); transition: 0.3s; }
        .map-selected { border-color: #f00; background: rgba(255,0,0,0.2); box-shadow: 0 0 15px #f00; }

        #audio-msg { color: #0f0; margin-bottom: 10px; animation: blink 1s infinite; cursor: pointer; }
        @keyframes blink { 50% { opacity: 0; } }

        #btn-jugar {
            background: #f00; border: none; color: white; padding: 15px 60px; font-size: 24px; cursor: pointer;
            font-weight: bold; clip-path: polygon(10% 0, 100% 0, 90% 100%, 0 100%); margin-top: 20px;
            opacity: 0.5; pointer-events: none;
        }
        .ready { opacity: 1 !important; pointer-events: all !important; }

        /* HUD */
        #hud { position: fixed; bottom: 85px; left: 20px; z-index: 10; display: none; }
        .stat-box { background: rgba(0, 0, 0, 0.85); color: #0f0; padding: 12px 20px; margin-top: 5px; min-width: 200px; font-size: 18px; border-left: 5px solid #f00; text-transform: uppercase; }
        #crosshair { position: fixed; top: 50%; left: 50%; width: 16px; height: 16px; border: 2px solid #0f0; border-radius: 50%; transform: translate(-50%, -50%); z-index: 10; display: none; }
    </style>
  </head>
  <body>

    <div id="menu-inicio">
        <div class="title-container"><h1>BLOCKS OPS</h1></div>
        <p id="audio-msg" onclick="desbloquearAudio()">[ 1. CLIC AQUÍ PARA CARGAR AUDIO ]</p>
        
        <div class="map-selector">
            <div id="map1" class="map-card" onclick="selectMap('almacen')">ALMACÉN</div>
            <div id="map2" class="map-card map-selected" onclick="selectMap('ciudad')">CIUDAD</div>
        </div>

        <button id="btn-jugar" onclick="iniciarJuego()">2. INICIAR MISIÓN</button>
    </div>

    <div id="crosshair"></div>
    <div id="hud">
        <div class="stat-box">ESTADO: <span id="hp">100%</span></div>
        <div class="stat-box">BALAS: <span id="ammo">30</span></div>
        <div class="stat-box">BAJAS: <span id="score">0</span></div>
    </div>

    <audio id="snd-glock" src="sound_weapons_glock18_glock18-1.wav"></audio>
    <audio id="music-menu" src="Snapiyy audio - I am my perimeter.mp3" loop></audio>
    <audio id="music-game" src="Don Aitor - Invasión zombi.mp3" loop></audio>

    <a-scene loading-screen="enabled: false">
      <a-sky id="sky" color="#111"></a-sky>
      <a-light type="ambient" intensity="0.8"></a-light>
      <a-light type="directional" position="1 10 5" intensity="0.6"></a-light>

      <a-entity id="rig" movement-controls="controls: keyboard; speed: 0.2">
        <a-entity id="camera" camera look-controls="pointerLockEnabled: true" position="0 1.